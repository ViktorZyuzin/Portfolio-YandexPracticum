# Описание проекта 

Чтобы оптимизировать производственные расходы, металлургический комбинат ООО «Так закаляем сталь» решил уменьшить потребление электроэнергии на этапе обработки стали. Вам предстоит построить модель, которая предскажет температуру стали.

**Целевой признак:** последняя измеренная температура

**Метрика:** МАЕ.

**Качество:** 6.8 и ниже

**RANDOM_STATE** = 50623


## Итоговый вывод

1. Какие пункты плана были выполнены, а какие — нет. Почему?
    
    **План выполнения работы:**

        1. Предобработаем данные
    
        2. Добавим признаки
    
        3. Объединим данные по столбцу `key` (столбец `key` есть во всех предоставленных данных)
    
        4. Разделим данные на Train:Test - 3:1
    
        5. Обучить несколько моделей
    
        6. Сравнить результаты, выбрать лучшую модель при помощи метрики MAE и проверим ее на тестовой выборке

    Были выполнены все пункты плана, только добавилось еще пару новых пунктов:
     
        Анализ полученных результатов
     
        Проверка модели на адекватность
     
        Влияние признаков

2. Какие трудности возникли и как вы их преодолели?
    
    - Основная трудность была с обучением моделей, изначально хотел добавить еще LGBMRegressor, но он почему-то не хотел у меня обучаться. Я его оставлял на ночь утром вставал и ничего не менялось. Менял код, Гиперпараметры. в итоге было принято решение оставить 2 модели.
   
    - Было небольшое непонимание что делать с данными в сете с температурой, но тимлид подсказал как быть(было недопонимание небольшое после вебинара)
    
    - Так же возникла трудность с оценкой адекватности модели, но тут помог гугл
    
    В остальном все было приемлимо.
    
3. Какие ключевые шаги в решении задачи вы выделили?
   
   Самые главные шаги были EDA и предобработка данных, именно они по моему мнению обеспечили наиболее качественный анализ и лучшую работу выбранных мной моделей.
   
   После были выбраны модели для обучиния и среди них определена лучшая и она была проверена на тестовой выборке, а так же на адекватность.(Выбор был по параметру МАЕ(Mean absolute error)).
   
4. Какие признаки использовали для обучения модели и какая предобработка этих признаков была выполнена? 

    - После всех манипуляций с данными в финальном датасете осталось 2329 строк и 29 столбцов:
        - `key`
        - `first_temp`
        - `last_temp`
        - `full_power`
        - `heat_time(sec)`
        - `wire_1 - wire_9`
        - `bulk_1 - bulk_15`
        - `gas`
    
    - В ходе проведения предобработки данных было выполнено несколько этапов:

        - Удалил пропуски, где нет возможности восстановить данные
        - Где было возможно, заполнил пропуски нулевыми значениями
        - Добавил признак полную мощьность
        - Добавил признак длительности нагрева электродами в секундах
        - Сгруппировал данные по партиям
        - Объеденил все в один датасет
        - Удалил строки где был всего один замер температуры
        - Привел названия столбцов к правильному виду
    
    - Для модели LinearRegression было решено удалить признак `wire_9` потому как у него была выявлена высокая коррелляция.

5. Какая ваша итоговая модель, какие у неё гиперпараметы и какое качество?  
    
    - Обучил две модели
        - CatBoostRegressor показала train MAE: 3.735 (test MAE: 6.267)
        - LinearRegression показала train MAE: 6.268
    - Сравнил результаты и выбрал лучшую модель CatBoostRegressor при помощи метрики MAE и проверил ее на тестовой выборке
        - CatBoostRegressor показала test MAE: 6.267
    - Гиперпараметры
        - 'iterations': 400, 'learning_rate': 0.05, 'max_depth': 6, cv=KFold(n_splits=5, random_state=50623, shuffle=True) 

